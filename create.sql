create table address (created_at timestamp(6), updated_at timestamp(6), establishment_id uuid, id uuid not null, user_id uuid, city varchar(255), complement varchar(255), neighborhood varchar(255), number varchar(255), postal_code varchar(255), state varchar(255), street varchar(255), primary key (id));
create table categories (category integer not null, category_type integer not null, created_at timestamp(6), updated_at timestamp(6), name varchar(255), primary key (category, category_type));
create table establishments (average_order_value integer, created_at timestamp(6), updated_at timestamp(6), id uuid not null, information_id uuid unique, cnpj varchar(255) unique, fantasy_name varchar(255), primary key (id));
create table establishments_categories (categories_category integer not null, categories_category_type integer not null, establishment_id uuid not null);
create table establishments_relationships (relationships_interaction_type tinyint not null, establishment_id uuid not null, relationships_establishment_id uuid not null, relationships_user_id uuid not null);
create table events (already_happened boolean, date date, price float(53), created_at timestamp(6), updated_at timestamp(6), id uuid not null, owner_id uuid, description varchar(255), title varchar(255), primary key (id));
create table informations (close_at time(6), has_accessibility boolean, has_parking boolean, has_tv boolean, has_wifi boolean, open_at time(6), created_at timestamp(6), updated_at timestamp(6), establishment_id uuid, id uuid not null, facebook_url varchar(255), instagram_url varchar(255), phone varchar(255), telegram_url varchar(255), primary key (id));
create table relationships (interaction_type tinyint not null check (interaction_type between 0 and 3), rate float(53), created_at timestamp(6), updated_at timestamp(6), establishment_id uuid not null, user_id uuid not null, message varchar(255), primary key (interaction_type, establishment_id, user_id));
create table users (created_at timestamp(6), updated_at timestamp(6), id uuid not null, email varchar(255), name varchar(255), password varchar(255), role_enum varchar(255) check (role_enum in ('ADMIN','USER')), primary key (id));
create table users_relationships (relationships_interaction_type tinyint not null, relationships_establishment_id uuid not null, relationships_user_id uuid not null, user_id uuid not null, unique (relationships_establishment_id, relationships_interaction_type, relationships_user_id));
alter table if exists address add constraint FKaeugg6r73auwl6u13qp2rhg7e foreign key (establishment_id) references establishments;
alter table if exists address add constraint FK6i66ijb8twgcqtetl8eeeed6v foreign key (user_id) references users;
alter table if exists establishments add constraint FKi8qe6q6w3eip4h00is2t14gim foreign key (information_id) references informations;
alter table if exists establishments_categories add constraint FKcvjx77gkuj4rygr4582166gu6 foreign key (categories_category, categories_category_type) references categories;
alter table if exists establishments_categories add constraint FK2bxws0op1tstutmwwkjdtmk3d foreign key (establishment_id) references establishments;
alter table if exists establishments_relationships add constraint FKe80bfu62v88o4ho8krus14kte foreign key (relationships_interaction_type, relationships_establishment_id, relationships_user_id) references relationships;
alter table if exists establishments_relationships add constraint FKkj67w15syd0n1wknygtt1rtfk foreign key (establishment_id) references establishments;
alter table if exists events add constraint FK7d5oq323njkxkmn3s5c7qkpe5 foreign key (owner_id) references establishments;
alter table if exists users_relationships add constraint FKhnrykfkyshjkn2bilyekj2x9t foreign key (relationships_interaction_type, relationships_establishment_id, relationships_user_id) references relationships;
alter table if exists users_relationships add constraint FKonexdypnvgmipbheetm78vhhi foreign key (user_id) references users;
INSERT INTO users(created_at, updated_at, id, email, name, password, role_enum) VALUES (NOW(), NOW(), 'e3af8953-b40f-4abd-a380-aa232fc3f67c', 'julioaugusto@gmail.com', 'Julio Augusto', '$2a$10$bHtmDusd0xrpxTN6xJyN5OvU20jMX466l6M.Gy6dtNpvmwM/O2R3m', 'ADMIN');
INSERT INTO ESTABLISHMENTS (AVERAGE_ORDER_VALUE, CREATED_AT, UPDATED_AT, ID, CNPJ, FANTASY_NAME) VALUES (50.0, NOW(), NULL, '48b6eafc-0a2f-4b8a-bfa5-6735b18d4961', '61736755000145', 'BEER4U'), (60.0, NOW(), NULL, '48b6eafc-0a2f-4b8a-bfa5-6735b18d4962', '61736755000146', 'BEER4Us'), (10.0, NOW(), NULL, '48b6eafc-0a2f-4b8a-bfa5-6735b18d4963', '61736755000147', 'Beer and you'), (90.0, NOW(), NULL, '48b6eafc-0a2f-4b8a-bfa5-6735b18d4964', '61736755000148', 'Pé na porta');
INSERT INTO CATEGORIES (CREATED_AT, UPDATED_AT, CATEGORY_TYPE, CATEGORY, NAME) VALUES (NOW(), null, 1, 1, 'music');
INSERT INTO ADDRESS (CREATED_AT, UPDATED_AT, ESTABLISHMENT_ID, ID, USER_ID, CITY, COMPLEMENT, NEIGHBORHOOD, NUMBER, POSTAL_CODE, STATE, STREET) VALUES (NOW(), NOW(), '48b6eafc-0a2f-4b8a-bfa5-6735b18d4961', 'd2f48f55-5f7b-4d3a-bc1a-9563ab25aa8e', null, 'São Paulo', 'Perto do Bar', 'Praça da Sé', '144', '001001-000', 'SP', 'Rua Principal');
INSERT INTO EVENTS (ALREADY_HAPPENED, DATE, PRICE, CREATED_AT, UPDATED_AT, ID, OWNER_ID, DESCRIPTION, TITLE) VALUES (FALSE, NOW(), 200.0, NOW(), NOW(), '91e8899a-e48e-4b26-ba76-ede29f288bbf', '48b6eafc-0a2f-4b8a-bfa5-6735b18d4961', 'Musica com caneta azul', 'Não perca a oportunidade');
INSERT INTO INFORMATIONS (CLOSE_AT, HAS_ACCESSIBILITY, HAS_PARKING, HAS_TV, HAS_WIFI, OPEN_AT, CREATED_AT, UPDATED_AT, ESTABLISHMENT_ID, ID, FACEBOOK_URL, INSTAGRAM_URL, PHONE, TELEGRAM_URL) VALUES (NOW(), TRUE, TRUE, TRUE, TRUE, NOW(), NOW(), NULL, '48b6eafc-0a2f-4b8a-bfa5-6735b18d4961', '7f0343e9-57f0-42b5-9d4b-1b8946bb6c56', 'www.google.com',  'www.google.com', '11988562536', 'www.google.com');
INSERT INTO RELATIONSHIPS (INTERACTION_TYPE, RATE, CREATED_AT, UPDATED_AT, ESTABLISHMENT_ID, USER_ID, MESSAGE) VALUES (1, 5.0, NOW(), NULL, '48b6eafc-0a2f-4b8a-bfa5-6735b18d4961', 'e3af8953-b40f-4abd-a380-aa232fc3f67c', 'Restaurante e Bar bão demais');
